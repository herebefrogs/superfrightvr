<html><head><title>JS13K 2024: SUP3RFR1GHT VR</title><script src=/lib/aframe-1.7.1.min.js></script><script>(()=>{zzfxV=.3,zzfxX=new AudioContext,zzfx=(t=1,e=.05,i=220,o=0,s=0,a=.1,r=0,n=1,l=0,h=0,d=0,c=0,m=0,u=0,p=0,g=0,b=0,A=1,v=0,y=0,f=0)=>{let E=Math,S=2*E.PI,k=44100,x=l*=500*S/k/k,M=i*=(1-e+2*e*E.random(e=[]))*S/k,z=0,D=0,R=0,T=1,C=0,j=0,w=0,F=0>f?-1:1,L=S*F*f*2/k,q=E.cos(L),I=E.sin,O=I(L)/4,H=1+O,P=-2*q/H,N=(1-O)/H,_=(1+F*q)/2/H,W=-(F+q)/H,V=_,G=0,X=0,B=0,U=0;for(h*=500*S/k**3,p*=S/k,d*=S/k,c*=k,m=k*m|0,t*=.3,F=(o=k*o+9)+(v*=k)+(s*=k)+(a*=k)+(b*=k)|0;F>R;e[R++]=w*t)++j%(100*g|0)||(w=r?r>1?r>2?r>3?I(z**3):E.max(E.min(E.tan(z),1),-1):1-(2*z/S%2+2)%2:1-4*E.abs(E.round(z/S)-z/S):I(z),w=(m?1-y+y*I(S*R/m):1)*(0>w?-1:1)*E.abs(w)**n*(o>R?R/o:o+v>R?1-(R-o)/v*(1-A):o+v+s>R?A:F-b>R?(F-R-b)/a*A:0),w=b?w/2+(b>R?0:(F-b>R?1:(F-R)/b)*e[R-b|0]/2/t):w,f&&(w=U=V*G+W*(G=X)+_*(X=w)-N*B-P*(B=U))),L=(i+=l+=h)*E.cos(p*D++),z+=L+L*u*I(R**5),T&&++T>c&&(i+=d,M+=d,T=0),!m||++C%m||(i=M,l=x,T=T||1);(t=zzfxX.createBuffer(1,F,k)).getChannelData(0).set(e),(i=zzfxX.createBufferSource()).buffer=t,i.connect(zzfxX.destination),i.start()},AFRAME.registerPrimitive("a-bullet",{defaultComponents:{bullet:{},"dynamic-collider":{},"linear-motion":{speed:2},ttl:15},mappings:{direction:"linear-motion.direction"}}),AFRAME.registerComponent("bullet",{events:{componentchanged(t){"linear-motion"===t.detail.name&&this.updateTrail(this.el.getAttribute("linear-motion").distanceTravelled)},ttlreached(){this.el.setAttribute("health",{hp:0})},obbcollisionstarted(t){const e=t.detail.withEl;e.components.health&&this.el.components.health.data.group!==e.components.health.data.group&&(e.setAttribute("health",{hp:e.components.health.data.hp-1}),this.el.setAttribute("health",{hp:0}))}},init(){const t=document.createElement("a-entity");t.setAttribute("geometry",{primitive:"cylinder",radius:.01,height:.04,segmentsRadial:6,segmentsHeight:1,openEnded:!1}),t.setAttribute("material",{color:"black"});const e=document.createElement("a-entity");e.setAttribute("line",{color:"red",opacity:.45,transparent:!0,start:"0 0 0",end:"0 0 0"}),t.appendChild(e),this.el.appendChild(t),this.trail=e,t.object3D.rotation.x=-Math.PI/2,e.object3D.rotation.x=-Math.PI/2},updateTrail(t){t>2.5||this.trail.setAttribute("line",{end:"0 0 -"+3*t/4})}}),AFRAME.registerPrimitive("a-gun",{defaultComponents:{gun:{},"dynamic-collider":{size:.15}}}),AFRAME.registerComponent("gun",{init(){const t=document.createElement("a-box");t.setAttribute("color","#000"),t.setAttribute("depth",.2),t.setAttribute("height",.08),t.setAttribute("width",.04),t.object3D.position.y=.06,t.object3D.position.z=-.08,this.el.appendChild(t);const e=document.createElement("a-box");e.setAttribute("color","#000"),e.setAttribute("depth",.08),e.setAttribute("height",.16),e.setAttribute("width",.04),e.object3D.rotation.x=-Math.PI/8,this.el.appendChild(e)}}),AFRAME.registerPrimitive("a-level",{defaultComponents:{level:{}},mapping:{"game-time-tracked":"level.gameTimeTracked"}}),AFRAME.registerComponent("level",{schema:{gameTimeTracked:{type:"boolean",default:!1}}}),AFRAME.registerPrimitive("a-portal",{defaultComponents:{portal:{},geometry:{primitive:"cone",thetaStart:45,segmentsRadial:4,segmentsHeight:1,radiusTop:0,radiusBottom:.2,height:.175},material:{color:"black",opacity:.45,transparent:!0,flatShading:!0},"dynamic-collider":{size:.15}},mappings:{to:"portal.to","text-value":"portal.textValue","text-width":"portal.textWidth"}}),AFRAME.registerComponent("portal",{schema:{to:{type:"string"},textValue:{type:"string"},textWidth:{type:"number"}},init(){const t=this.data,e=document.createElement("a-entity");e.setAttribute("text",{value:t.textValue,align:"center",font:"monoid",width:t.textWidth}),e.setAttribute("position",{x:0,y:-.04,z:.05}),this.el.appendChild(e)}}),AFRAME.registerPrimitive("a-pyramid",{defaultComponents:{geometry:{primitive:"cone",thetaStart:45,segmentsRadial:4,segmentsHeight:1,radiusTop:0},material:{flatShading:!0}},mappings:{color:"material.color",height:"geometry.height",width:"geometry.radiusBottom"}}),AFRAME.registerPrimitive("a-gimbal",{defaultComponents:{rotation:{}}}),AFRAME.registerComponent("dynamic-collider",{schema:{size:{type:"number",default:0}},events:{componentchanged(t){"visible"===t.detail.name&&this.init()}},init(){this.el.getAttribute("visible")?this.el.setAttribute("obb-collider",{size:this.data.size}):this.el.removeAttribute("obb-collider")}}),AFRAME.registerComponent("game-time",{schema:{type:"number",default:0},init(){this.format=new Intl.NumberFormat(navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2}).format},update(){this.el.setAttribute("value",this.format(this.data)+"s")}}),AFRAME.registerComponent("gravity",{schema:{type:"boolean",default:!1},events:{componentchanged(t){"gravity"===t.detail.name&&this.el.sceneEl.emit("gravity-changed",{el:this.el,gravity:this.data})}}}),AFRAME.registerComponent("gesture-tracker",{events:{gripdown(){this.el.addState("grabbing")},gripup(){this.el.removeState("grabbing")},triggerdown(){this.el.addState("shooting")},triggerup(){this.el.removeState("shooting")},obbcollisionstarted(t){const e=t.detail.withEl;e.hasAttribute("gesture-tracker")||(e.hasAttribute("portal")||e.hasAttribute("gun"))&&this.addState("hovering",e)},obbcollisionended(t){const e=t.detail.withEl;e.hasAttribute("gesture-tracker")||(e.hasAttribute("portal")||e.hasAttribute("gun"))&&this.removeState("hovering",e)}},init(){this.state2targets={hovering:[],holding:[]},this.el.sceneEl.addEventListener("levelloaded",(()=>{this.reset()}))},addState(t,e){this.state2targets[t]=this.state2targets[t].filter((t=>t!==e)),this.state2targets[t].push(e),"holding"===t&&e.addState("held"),this.el.addState(t)},getState(t){return"holding"===t?this.state2targets[t][0]:this.state2targets[t]},removeState(t,e){this.state2targets[t]=this.state2targets[t].filter((t=>t!==e)),"holding"===t&&e.removeState("held"),this.state2targets[t].length||this.el.removeState(t)},reset(){for(state in this.state2targets)this.state2targets[state].forEach((t=>this.removeState(state,t)));const t=document.querySelector(`#${this.el.id} a-gimbal`);t&&this.el.removeChild(t)}}),AFRAME.registerComponent("health",{schema:{hp:{type:"int",default:1},group:{type:"string",default:"foe"}},events:{obbcollisionstarted(t){const e=t.detail.withEl;if(e.components.health){const t=this.el.components.health.data.group;t!==e.components.health.data.group&&("friend"===t&&this.el.is("shooting")&&!this.el.is("holding-gun")||"foe"===t&&e.components["motion-tracker"]&&!e.is("shooting"))&&e.setAttribute("health",{hp:e.components.health.data.hp-1})}}},update(){this.data.hp>0||this.el.components["motion-tracker"]||this.el.parentNode.components["motion-tracker"]||(this.el.parentNode.removeChild(this.el),this.el.pause())}}),AFRAME.registerComponent("linear-motion",{schema:{direction:{type:"vec3",default:{x:0,y:0,z:0}},speed:{type:"number",default:1},distanceTravelled:{type:"number",default:0}}}),AFRAME.registerComponent("spin-motion",{schema:{direction:{type:"vec3",default:{x:0,y:0,z:0}},speed:{type:"number",default:1}}}),AFRAME.registerComponent("sinlinear-motion",{schema:{direction:{type:"vec3",default:{x:0,y:0,z:0}},speed:{type:"number",default:1},alpha:{type:"number",default:0}}}),POSITION_MIN_MOTION=1e-7,POSITION_MAX_MOTION=1e-5,ROTATION_MIN_MOTION=1e-6,ROTATION_MAX_MOTION=.001;var t=(t,e,i)=>THREE.MathUtils.mapLinear(THREE.MathUtils.clamp(t,e,i),e,i,0,1);function e(t){return new THREE.Vector3(t.x,t.y,t.z)}AFRAME.registerComponent("motion-tracker",{init(){this.prevPos=this.el.object3D.position.clone(),this.prevRot=e(this.el.object3D.rotation)},tick(){const i=e(this.el.object3D.rotation),o=this.prevRot.distanceToSquared(i),s=this.prevPos.distanceToSquared(this.el.object3D.position);this.slowMotion=Math.max(t(s,1e-7,1e-5),t(o,1e-6,.001)),this.prevRot=i,this.prevPos=this.el.object3D.position.clone()}}),AFRAME.registerComponent("puppet",{events:{ttlreached(t){const e=t.detail.el;e.parentNode.removeChild(e),e.setAttribute("health",{hp:0})}}}),AFRAME.registerComponent("sniper",{schema:{frequency:{type:"number",default:1.5},firstShotDelay:{type:"number",default:.5}},init(){this.nextShotDelay=this.data.firstShotDelay,this.playerHead=document.querySelector("a-camera").object3D,this.el.sceneEl.addEventListener("tick",(t=>{this._tick(t.detail.time,t.detail.timeDelta)}))},_tick(t,e){this.el.isPlaying&&(this.nextShotDelay-=e,this.nextShotDelay>0||(this.nextShotDelay+=this.data.frequency,this.fireBullet()))},fireBullet(){zzfx(1,.05,62,.01,.07,.4,2,2.8,6,-8,0,0,0,1.4,28,.4,0,.4,.1,.46,181);const t=this.el.object3D,e=t.localToWorld(t.position.clone()),i=this.playerHead.position.clone();i.y-=.05;const o=(new THREE.Vector3).subVectors(i,e).normalize(),s=o.clone().negate(),a=document.createElement("a-bullet");a.setAttribute("position",e),a.object3D.lookAt(s),a.setAttribute("linear-motion",{direction:o}),a.setAttribute("health",{group:this.el.getAttribute("health").group}),document.querySelector("a-level").appendChild(a)}}),AFRAME.registerComponent("ttl",{schema:{type:"number",default:10},init(){this.timeLeft=this.data,this.el.sceneEl.addEventListener("tick",(t=>this._tick(t.detail.time,t.detail.timeDelta)))},_tick(t,e){this.timeLeft-=e,0>this.timeLeft&&(this.el.removeAttribute("ttl"),this.el.emit("ttlreached",{el:this.el}))}}),SLOWMO_RATIO=2,AFRAME.registerSystem("game-time",{schema:{type:"number",default:0},init(){this.playerLimbs=document.querySelectorAll("[motion-tracker]")},tick(t,e){const i=this.el;let o=0;for(limb of this.playerLimbs)o=Math.max(limb.components["motion-tracker"].slowMotion,o);(e=o/2*e/1e3)&&(i.is("game-time-tracked")&&(this.data+=e),i.emit("tick",{time:this.data,timeDelta:e}))},toggleGameTimeHUDVisibility(t){this.gameTimeHUD.object3D.visible=t}}),AFRAME.registerSystem("gesture-tracker",{init(){this.hands=Array.from(document.querySelectorAll("[gesture-tracker]"))},tick(){this.hands.find((t=>{const e=t.components["gesture-tracker"];if(t.is("hovering")&&t.is("grabbing")&&!t.is("holding"))return!!e.getState("hovering").find((i=>i.hasAttribute("portal")?(zzfx(1,.05,166,.07,.11,.15,0,2.8,-3,-186,0,0,.1,0,0,.1,0,.55,.26,0,0),this.el.emit("loadlevel",{levelId:i.components.portal.data.to}),!0):i.hasAttribute("gun")&&!i.is("held")?(this.grabGun(i,t,e),!0):void 0));if(t.is("holding")&&!t.is("grabbing")){const i=e.getState("holding");if(i.hasAttribute("gun"))return this.dropGun(i,t,e),!0}else if(t.is("holding")&&t.is("shooting")){const i=e.getState("holding");if(i.hasAttribute("gun"))return t.removeState("shooting"),this.shootGun(i),!0}return!1}))},grabGun(t,e,i){zzfx(1,.05,43,0,.44,.03,1,1.8,-18,-58,0,0,.01,.4,0,.1,0,.77,.11,0,0),t.parentNode.removeChild(t);const o=document.createElement("a-gun");o.id=parseInt(t.id)+1,o.setAttribute("health",t.getAttribute("health")),o.setAttribute("position","0 0 0");const s=document.createElement("a-gimbal");s.setAttribute("rotation","-90 0 0"),s.appendChild(o),e.appendChild(s),i.addState("holding",o)},dropGun(t,e,i){zzfx(1,.05,43,0,.44,.03,1,1.8,-18,-58,0,0,.01,.4,0,.1,0,.77,.11,0,0);const o=t.parentNode,s=(new THREE.Euler).setFromQuaternion(o.object3D.getWorldQuaternion(new THREE.Quaternion),"XYZ");e.removeChild(o),i.removeState("holding",t);const a=document.createElement("a-gun");a.id=parseInt(t.id)+1,a.setAttribute("health",t.getAttribute("health")),a.setAttribute("position",e.getAttribute("position")),a.object3D.rotation.set(s.x,s.y,s.z),a.setAttribute("gravity",!0),document.querySelector("a-level").appendChild(a)},shootGun(t){zzfx(1,.05,62,.01,.07,.4,2,2.8,6,-8,0,0,0,1.4,28,.4,0,.4,.1,.46,181);const e=t.object3D.localToWorld(new THREE.Vector3(0,.08,-.2)),i=t.object3D.getWorldDirection(new THREE.Vector3),o=i.clone().negate(),s=document.createElement("a-bullet");s.setAttribute("position",e),s.object3D.lookAt(i),s.setAttribute("linear-motion",{direction:o}),s.setAttribute("health",{group:t.getAttribute("health").group}),document.querySelector("a-level").appendChild(s)}}),GRAVITY=.49,FLOOR_HEIGHT=.1,AFRAME.registerSystem("puppeteer",{init(){this.playerLimbs=[...document.querySelectorAll("[motion-tracker]")],this.retry=document.querySelector("#retry"),this.el.addEventListener("tick",(t=>this._tick(t.detail.time,t.detail.timeDelta))),this.el.addEventListener("child-attached",(t=>{this.trackEntity(t.detail.el)})),this.el.addEventListener("child-detached",(t=>{this.untrackEntity(t.detail.el)})),this.el.addEventListener("gravity-changed",(t=>{this[t.detail.gravity?"trackEntity":"untrackEntity"](t.detail.el)})),this.el.addEventListener("levelloaded",(()=>this.reset()))},_tick(t,e){for(let t of this.gravitas)t.getAttribute("gravity")&&t.object3D.position.y>.1&&(t.object3D.position.y=Math.max(.1,t.object3D.position.y-.49*e));for(let t of this.walkers){const i=t.components["linear-motion"],{speed:o,direction:s,distanceTravelled:a}=i.data,r=o*e,n=s.x*r,l=s.y*r,h=s.z*r;t.object3D.position.x+=n,t.object3D.position.y+=l,t.object3D.position.z+=h,t.setAttribute("linear-motion",{distanceTravelled:a+Math.sqrt(n*n+l*l+h*h)})}for(let t of this.sinWalkers){const i=t.components["sinlinear-motion"];let{speed:o,direction:s,alpha:a}=i.data;a+=Math.PI*e;const r=o*e*Math.sin(a),n=s.y*r,l=s.z*r;t.object3D.position.x+=s.x*r,t.object3D.position.y+=n,t.object3D.position.z+=l,t.setAttribute("sinlinear-motion",{alpha:a})}for(let t of this.spinners){const i=t.components["spin-motion"],{speed:o,direction:s}=i.data,a=o*e;t.object3D.rotation.x+=s.x*a,t.object3D.rotation.y+=s.y*a,t.object3D.rotation.z+=s.z*a}for(let t of this.puppets)t.components.health.data.hp||(zzfx(2.1,.05,315,.02,.02,.25,3,2.2,0,0,0,0,.02,0,32,.1,.17,.7,.07,.42,-1696),this.puppets=this.puppets.filter((e=>e!==t)));if(this.puppets.length){if(!this.retry.getAttribute("visible"))for(limb of this.playerLimbs)if(!limb.getAttribute("health")?.hp){this.showRetry();break}}else this.showNextLevelPortal()},showNextLevelPortal(){this.el.is("level-cleared")||(this.el.addState("level-cleared"),this.el.removeState("game-time-tracked"),setTimeout((()=>{zzfx(1.7,.05,281,.04,.13,.35,0,1.7,0,-22,227,.09,.09,.3,0,0,.17,.6,.21,.28,-1463),this.portal.setAttribute("visible",!0)}),1e3))},showRetry(){this.el.is("game-over")||(this.el.addState("game-over"),zzfx(1,.05,148,.02,.01,.18,3,.2,.1,.8,0,-.05,0,.1,-4,.3,0,.68,.08,.01,103),setTimeout((()=>{zzfx(1.7,.05,507,.07,.23,.17,0,2.5,0,7,-85,.07,.02,0,0,0,.15,.72,.15,0,0),this.retry.setAttribute("portal",{to:"#"+document.querySelector("a-level").id}),this.retry.setAttribute("visible",!0)}),1e3))},reset(){this.walkers=[...document.querySelectorAll("a-level [linear-motion]")],this.sinWalkers=[...document.querySelectorAll("a-level [sinlinear-motion]")],this.spinners=[...document.querySelectorAll("a-level [spin-motion]")],this.gravitas=[...document.querySelectorAll("a-level [gravity]")],this.puppets=[...document.querySelectorAll("a-level [puppet]")],this.portal=document.querySelector("a-level a-portal"),this.retry.setAttribute("visible",!1),this.playerLimbs.forEach((t=>t.setAttribute("health",{hp:1})))},trackEntity(t){t.components["linear-motion"]&&!this.walkers.includes(t)&&this.walkers.push(t),t.components["spin-motion"]&&!this.spinners.includes(t)&&this.spinners.push(t),t.components["sinlinear-motion"]&&!this.sinWalkers.includes(t)&&this.sinWalkers.push(t),t.components.gravity&&!this.gravitas.includes(t)&&this.gravitas.push(t)},untrackEntity(t){t.components["linear-motion"]&&(this.walkers=this.walkers.filter((e=>e!==t))),t.components["spin-motion"]&&(this.spinners=this.spinners.filter((e=>e!==t))),t.components["sinlinear-motion"]&&(this.sinWalkers=this.sinWalkers.filter((e=>e!==t))),t.components.gravity&&(this.gravitas=this.gravitas.filter((e=>e!==t)))}}),AFRAME.registerSystem("level",{init(){this.hands=document.querySelectorAll("[gesture-tracker]");const t=this.el;t.addEventListener("loadlevel",(t=>this.loadLevel(t.detail.levelId))),t.addEventListener("loaded",(()=>{this.loadLevel("#title"),this.el.addState("level-cleared")}))},loadLevel(t){const e=document.querySelector("a-level");e&&document.querySelector("a-scene").removeChild(e);const i=document.createElement("div");i.innerHTML=document.querySelector("#level_templates").innerHTML;const o=i.querySelector(""+t);document.querySelector("a-scene").appendChild(o),this.el[o.getAttribute("gameTimeTracked")?"addState":"removeState"]("game-time-tracked"),this.el.removeState("level-cleared"),this.el.removeState("game-over"),this.el.emit("levelloaded",{level:o})}})})();</script></head><body><a-scene><a-portal id=retry position="0 1 -0.65" text-value=RETRY text-width=1.4 visible=false></a-portal><a-sky color=#ddd></a-sky><a-camera motion-tracker health="group: friend" obb-collider="size: 0.2"></a-camera><a-entity id=left hand-controls="hand: left; handModelStyle: toon" position="-0.5 1 0" health="group: friend" obb-collider="size: 0.1" motion-tracker gesture-tracker><a-text value=1 color=black font=monoid align=center width=1 position="-0.028 0.05 0" rotation="185 90 0"></a-text></a-entity><a-entity id=right hand-controls="hand: right; handModelStyle: toon" position="0.5 1 0" health="group: friend" obb-collider="size: 0.1" motion-tracker gesture-tracker><a-text value=3 color=black font=monoid align=center width=1 position="0.028 0.05 0" rotation="185 -90 0"></a-text></a-entity></a-scene><script id=level_templates type=text/html><a-level id="title">
        <a-text
          value="SUP3RFR1GHT VR"
          align="center"
          color="#ef2d5e"
          font="monoid"
          width="20"
          position="0 2.5 -5"
        ></a-text>

        <a-text
          value="A GAME BY JEROME LECOMTE FOR JS13K 2024" position="0 1.8 -5"
          align="center" font="monoid" width="5">
        </a-text>
        <a-text
          value="press GRIP to GRAB objects\npress TRIGGER to shoot or punch" position="0 0.5 -5"
          align="center" color="black" font="monoid" width="5" height="2">
        </a-text>


        <a-portal to="#level_1" text-value="GRAB" text-width="1.75"
          position="0 1 -0.65"></a-portal>
      </a-level>

      <a-level id="level_1" game-time-tracked>
        <!-- grabbable stuff -->
        <a-gun position="0 1.2 -0.5" health="group: friend"></a-gun>
        <a-portal position="0 1 -0.65" to="#level_2" text-value="GRAB" text-width="1.75" visible="false"></a-portal>

        <!-- enemy -->
        <a-tetrahedron
          puppet
          radius="1" color="#ef2d5e"
          position="0 1.25 -3" rotation="0 -45 0" spin-motion="direction: 1 1 1; speed: 2"
          health="group: foe"
          dynamic-collider="size: 1"
        >
        </a-tetrahedron>

        <!-- room -->
        <a-cylinder radius="4" height="30" segments-radial="4" segments-height="1" theta-start="45"
          geometry="openEnded: true" material="color: #f7fafd; side: back; flatShading: true"
          position="0 2 0" rotation="-90 0 0"
        >
          <a-text value="TIME MOVES\nWHEN YOU MOVE" align="center" font="monoid" width="12" position="0 5.5 1" rotation="90 0 0"></a-text>
        </a-cylinder>
      </a-level>

      <a-level id="level_2" game-time-tracked>
        <!-- grabbable stuff -->
        <a-portal position="0 1 -0.65" to="#level_3" text-value="GRAB" text-width="1.75" visible="false"></a-portal>

        <!-- enemy -->
        <a-box
          puppet
          color="#ef2d5e"
          position="0 1 -2" spin-motion="direction: 1 0 0.5; speed: 2" sinlinear-motion="direction: 0 0 1"
          health="group: foe"
          dynamic-collider
        >
        </a-box>

        <!-- room -->
        <a-cylinder
          radius="4" height="30" segments-radial="5" segments-height="1"
          geometry="openEnded: true" material="color: #f7fafd; side: back; flatShading: true"
          position="0 2 0" rotation="-90 0 0"
        >
          <a-text value="PUNCH THRU" align="center" font="monoid" width="15" position="0 5.5 1" rotation="90 0 0"></a-text>
        </a-cylinder>
      </a-level>

      <a-level id="level_3" game-time-tracked>
        <!-- grabbable stuff -->
        <a-portal position="0 1 -0.65" to="#level_4" text-value="GRAB" text-width="1.75" visible="false"></a-portal>

        <!-- enemy -->
        <a-octahedron
          position="0 0.9 -5"
          radius="1" scale="0.5 1 0.5" material="color: #ef2d5e; flatShading: true"
          puppet
          health="group: foe"
          dynamic-collider
          linear-motion="direction: 0 0 1; speed: 0.8" spin-motion="direction: 0 1 0; speed: 1"
          ttl="16"
        >
        </a-octahedron>
        <a-entity position="-0.4 1.24 -4.5" rotation="90 0 0" linear-motion="direction: 0.15 0 1; speed: 2.5">
          <a-pyramid
            scale="0.25 0.6 0.25" rotation="0 45 0" color="#ef2d5e"
            spin-motion="direction: 0 -1 0; speed: 2"
            puppet dynamic-collider health="group: foe" ttl="5"
          ></a-pyramid>
        </a-entity>
        <a-entity position="0.4 1.24 -4.5" rotation="90 0 0" linear-motion="direction: -0.15 0 1; speed: 1.5">
          <a-pyramid
           scale="0.25 0.6 0.25" rotation="0 45 0" color="#ef2d5e"
           spin-motion="direction: 0 1 0; speed: 2"
           puppet dynamic-collider health="group: foe" ttl="5"
          ></a-pyramid>
        </a-entity>

        <!-- room -->
        <a-cylinder
          radius="4" height="30" segments-radial="6" segments-height="1" theta-start="30"
          geometry="openEnded: true" material="color: #f7fafd; side: back; flatShading: true"
          position="0 2 0" rotation="-90 0 0"
          >
          <a-text value="MOVE YOUR BODY" align="center" font="monoid" width="15" position="0 5.5 1" rotation="90 0 0"></a-text>
        </a-cylinder>
      </a-level>

      <a-level id="level_4" game-time-tracked>
        <!-- grabbable stuff -->
        <a-gun position="-0.35 1.2 -0.4" health="group: friend"></a-gun>
        <a-gun position="0.35 1.2 -0.4" health="group: friend"></a-gun>
        <a-portal position="0 1 -0.65" to="#last_level" text-value="GRAB" text-width="1.75" visible="false"></a-portal>

        <!-- enemy -->
        <a-entity position="0 2 -3" spin-motion="direction: 0 -0.5 0" sinlinear-motion="direction: 0 -1 0">
          <a-dodecahedron radius="0.5" material="color: #ef2d5e; flatShading: true"
            spin-motion="direction: 1 -1 0; speed: 2"
            puppet sniper="firstShotDelay: 1.5" dynamic-collider health="group: foe" >
          </a-dodecahedron>

          <a-entity rotation="0 0 0" >
            <a-pyramid
              width="0.25" depth="0.25" position="0.75 0 0" sinlinear-motion="direction: 2.5 0 0" rotation="180 135 45" color="#ef2d5e"
              puppet dynamic-collider health="group: foe">
            </a-pyramid>
          </a-entity>
          <a-entity rotation="0 45 0">
            <a-pyramid
              width="0.25" depth="0.25" position="0.75 0 0" sinlinear-motion="direction: 2.5 0 0" rotation="180 135 45" color="#ef2d5e"
              puppet dynamic-collider health="group: foe">
            </a-pyramid>
          </a-entity>
          <a-entity rotation="0 90 0">
            <a-pyramid
              width="0.25" depth="0.25" position="0.75 0 0" sinlinear-motion="direction: 2.5 0 0" rotation="180 135 45" color="#ef2d5e"
              puppet dynamic-collider health="group: foe">
            </a-pyramid>
          </a-entity>
          <a-entity rotation="0 135 0">
            <a-pyramid
              width="0.25" depth="0.25" position="0.75 0 0" sinlinear-motion="direction: 2.5 0 0" rotation="180 135 45" color="#ef2d5e"
              puppet dynamic-collider health="group: foe">
            </a-pyramid>
          </a-entity>
          <a-entity rotation="0 180 0">
            <a-pyramid
              width="0.25" depth="0.25" position="0.75 0 0" sinlinear-motion="direction: 2.5 0 0" rotation="180 135 45" color="#ef2d5e"
              puppet dynamic-collider health="group: foe">
            </a-pyramid>
          </a-entity>
          <a-entity rotation="0 -45 0">
            <a-pyramid
              width="0.25" depth="0.25" position="0.75 0 0" sinlinear-motion="direction: 2.5 0 0" rotation="180 135 45" color="#ef2d5e"
              puppet dynamic-collider health="group: foe">
            </a-pyramid>
          </a-entity>
          <a-entity rotation="0 -90 0">
            <a-pyramid
              width="0.25" depth="0.25" position="0.75 0 0" sinlinear-motion="direction: 2.5 0 0" rotation="180 135 45" color="#ef2d5e"
              puppet dynamic-collider health="group: foe">
            </a-pyramid>
          </a-entity>
          <a-entity rotation="0 -135 0">
            <a-pyramid
              width="0.25" depth="0.25" position="0.75 0 0" sinlinear-motion="direction: 2.5 0 0" rotation="180 135 45" color="#ef2d5e"
              puppet dynamic-collider health="group: foe">
            </a-pyramid>
          </a-entity>
        </a-entity>

        <!-- room -->
        <a-box
          width="12" depth="12" height="5"
          color="#f7fafd" material="side: back"
          position="0 2.5 -4"
        >
          <a-box width="1" depth="1" height="5" color="#f7fafd"  position="3 0 3"></a-box>
          <a-box width="0.5" depth="6" height="0.5" color="#f7fafd" position="-3 1.4 0"></a-box>
          <a-box width="1" depth="1" height="5" color="#f7fafd"  position="3 0 -3"></a-box>
          <a-box width="1" depth="1" height="5" color="#f7fafd"  position="-3 0 3"></a-box>
          <a-box width="0.5" depth="6" height="0.5" color="#f7fafd" position="3 1.4 0"></a-box>
          <a-box width="1" depth="1" height="5" color="#f7fafd"  position="-3 0 -3"></a-box>
          <a-text value="JAIL SUBJECT 13\nKNOWS" align="center" font="monoid" width="15" position="0 1 -5"></a-text>
        </a-box>
        <a-plane height="12" width="12" position="0 0.01 -4" rotation="-90 0 0"></a-plane>
      </a-level>

      <a-level id="last_level" game-time-tracked>
        <!-- grabbable stuff -->
        <a-gun position="0 1.5 -0.75" health="group: friend"></a-gun>
        <a-portal position="0 1 -0.65" to="#end" text-value="GRAB" text-width="1.75" visible="false"></a-portal>

        <!-- enemy -->
        <a-entity position="0 1.25 -5"
          spin-motion="direction: 0 0 1; speed: 4"
          linear-motion="direction: 0 0 1; speed: 0.33"
          sinlinear-motion="direction: -1 0 0">
          <a-torus-knot
            p="5" q="11" radius="0.25" radius-tubular="0.05"
            material="color: #ef2d5e; flatShading: true"
            puppet
            sniper="firstShotDelay: 0.25; frequency: 0.75"
            health="group: foe"
            dynamic-collider>
            <a-pyramid width="0.1" depth="0.1" height="0.5" position="0.45 0 0.45" rotation="90 35 0" color="#ef2d5e"></a-pyramid>
            <a-entity rotation="0 0 60"><a-pyramid width="0.1" depth="0.1" height="0.5" position="0.45 0 0.45" rotation="90 35" color="#ef2d5e"></a-pyramid></a-entity>
            <a-entity rotation="0 0 120"><a-pyramid width="0.1" depth="0.1" height="0.5" position="0.45 0 0.45" rotation="90 35" color="#ef2d5e"></a-pyramid></a-entity>
            <a-entity rotation="0 0 180"><a-pyramid width="0.1" depth="0.1" height="0.5" position="0.45 0 0.45" rotation="90 35" color="#ef2d5e"></a-pyramid></a-entity>
            <a-entity rotation="0 0 240"><a-pyramid width="0.1" depth="0.1" height="0.5" position="0.45 0 0.45" rotation="90 35" color="#ef2d5e"></a-pyramid></a-entity>
            <a-entity rotation="0 0 300"><a-pyramid width="0.1" depth="0.1" height="0.5" position="0.45 0 0.45" rotation="90 35" color="#ef2d5e"></a-pyramid></a-entity>
          </a-torus-knot>
        </a-entity>

        <a-entity position="-6 1.25 -4"
          spin-motion="direction: 0 0 1; speed: 4"
          linear-motion="direction: 1.25 0 1; speed: 0.33"
          sinlinear-motion="direction: -1 0 0"
          rotation="0 55 0">
          <a-torus-knot
            p="5" q="11" radius="0.25" radius-tubular="0.05"
            material="color: #ef2d5e; flatShading: true"
            puppet
            sniper="firstShotDelay: 0.75; frequency: 1.5"
            health="group: foe"
            dynamic-collider>
            <a-pyramid width="0.1" depth="0.1" height="0.5" position="0.45 0 0.45" rotation="90 35 0" color="#ef2d5e"></a-pyramid>
            <a-entity rotation="0 0 60"><a-pyramid width="0.1" depth="0.1" height="0.5" position="0.45 0 0.45" rotation="90 35" color="#ef2d5e"></a-pyramid></a-entity>
            <a-entity rotation="0 0 120"><a-pyramid width="0.1" depth="0.1" height="0.5" position="0.45 0 0.45" rotation="90 35" color="#ef2d5e"></a-pyramid></a-entity>
            <a-entity rotation="0 0 180"><a-pyramid width="0.1" depth="0.1" height="0.5" position="0.45 0 0.45" rotation="90 35" color="#ef2d5e"></a-pyramid></a-entity>
            <a-entity rotation="0 0 240"><a-pyramid width="0.1" depth="0.1" height="0.5" position="0.45 0 0.45" rotation="90 35" color="#ef2d5e"></a-pyramid></a-entity>
            <a-entity rotation="0 0 300"><a-pyramid width="0.1" depth="0.1" height="0.5" position="0.45 0 0.45" rotation="90 35" color="#ef2d5e"></a-pyramid></a-entity>
          </a-torus-knot>
        </a-entity>

        <a-entity position="6 1.25 -4"
          spin-motion="direction: 0 0 1; speed: 4"
          linear-motion="direction: -1.25 0 1; speed: 0.33"
          sinlinear-motion="direction: -1 0 0"
          rotation="0 -55 0">
          <a-torus-knot
            p="5" q="11" radius="0.25" radius-tubular="0.05"
            material="color: #ef2d5e; flatShading: true"
            puppet
            sniper="firstShotDelay: 0.55; frequency: 1.5"
            health="group: foe"
            dynamic-collider>
            <a-pyramid width="0.1" depth="0.1" height="0.5" position="0.45 0 0.45" rotation="90 35 0" color="#ef2d5e"></a-pyramid>
            <a-entity rotation="0 0 60"><a-pyramid width="0.1" depth="0.1" height="0.5" position="0.45 0 0.45" rotation="90 35" color="#ef2d5e"></a-pyramid></a-entity>
            <a-entity rotation="0 0 120"><a-pyramid width="0.1" depth="0.1" height="0.5" position="0.45 0 0.45" rotation="90 35" color="#ef2d5e"></a-pyramid></a-entity>
            <a-entity rotation="0 0 180"><a-pyramid width="0.1" depth="0.1" height="0.5" position="0.45 0 0.45" rotation="90 35" color="#ef2d5e"></a-pyramid></a-entity>
            <a-entity rotation="0 0 240"><a-pyramid width="0.1" depth="0.1" height="0.5" position="0.45 0 0.45" rotation="90 35" color="#ef2d5e"></a-pyramid></a-entity>
            <a-entity rotation="0 0 300"><a-pyramid width="0.1" depth="0.1" height="0.5" position="0.45 0 0.45" rotation="90 35" color="#ef2d5e"></a-pyramid></a-entity>
          </a-torus-knot>
        </a-entity>

        <!-- room -->
        <a-plane height="100" width="100" rotation="-90 0 0"></a-plane>
        <!-- tombs -->
        <a-box width="1" depth="0.2" height="1" color="#f7fafd" position="-5 0.5 -5" rotation="0 0 10">
          <a-cylinder color="#f7fafd"  height="0.2" radius="0.5" position="0 0.5 0" rotation="90 0 0"></a-cylinder>
          <a-text value="JUST" align="center" font="monoid" width="8" position="0 0.25 0.1"></a-text>  
        </a-box>
        <a-box width="1" depth="0.2" height="1" color="#f7fafd" position="-2 0.25 -4.5" rotation="0 -15 -5">
          <a-cylinder color="#f7fafd"  height="0.2" radius="0.5" position="0 0.5 0" rotation="90 0 0"></a-cylinder>
          <a-text value="SHOOT" align="center" font="monoid" width="7" position="0 0.25 0.1"></a-text>  
        </a-box>
        <a-box width="1" depth="0.2" height="2" color="#f7fafd" position="1.25 1 -6.5" rotation="0 10 0">
          <a-text value="13" align="center" font="monoid" width="12" position="0 0.25 0.1"></a-text>  
        </a-box>
        <a-box width="1.2" depth="0.2" height="1.2" color="#f7fafd" position="2.5 0.6 -4" rotation="0 10 0">
          <a-cylinder color="#f7fafd"  height="0.2" radius="0.5" position="0 0.4 0" rotation="90 0 0"></a-cylinder>
          <a-text value="KNUCKLE-\nHEADS!" align="center" font="monoid" width="5" position="0 0.25 0.1"></a-text>  
        </a-box>

        <a-box width="1.5" depth="0.25" height="0.75" position="0 0.375 -1" color="#f7fafd">
          <a-cylinder color="#f7fafd"  height="0.25" radius="0.5" position="0 0.4 0" rotation="90 0 0" health="group: friend; hp: 999" dynamic-collider></a-cylinder>
          <a-text value="GOD\nALL MIGHTY\nEXTERMINATE\nSWIFTLY" align="center" font="monoid" width="3" height="10" position="0 0.4 0.15"></a-text>  
        </a-box>
        <a-box width="1" depth="0.2" height="1" color="#f7fafd" position="-2 0.55 -2.5" rotation="0 0 -5"></a-box>
        <a-box width="1" depth="0.2" height="1" color="#f7fafd" position="4.5 0 -1.25" rotation="0 -35 -10">
          <a-cylinder color="#f7fafd"  height="0.2" radius="0.5" position="0 0.5 0" rotation="90 0 0"></a-cylinder>
        </a-box>
        <a-box width="1" depth="0.2" height="2.5" color="#f7fafd" position="-4.25 0 -1.5" rotation="0 40 15">
          <a-cylinder color="#f7fafd"  height="0.2" radius="0.5" position="0 1.7 0" rotation="90 0 0"></a-cylinder>
        </a-box>

        <!-- crypt -->
        <a-box width="4" depth="5" height="5" color="#f7fafd" position="-8 3.5 -15" rotation="0 10 0">
          <a-box width="5" depth="6" height="0.5" color="#f7fafd" position="0 3.25 0"></a-box>
          <a-box width="4.5" depth="5.5" height="0.5" color="#f7fafd" position="0 2.75 0"></a-box>
          <a-box width="4.5" depth="5.5" height="0.5" color="#f7fafd" position="0 -2.75 0"></a-box>
          <a-box width="5" depth="6" height="0.5" color="#f7fafd" position="0 -3.25 0"></a-box>
          <a-box width="1" depth="0.5" height="4" color="#f7fafd" position="0 5 2.5"></a-box>
          <a-box width="3" depth="0.5" height="1" color="#f7fafd" position="0 5.5 2.5"></a-box>
        </a-box>

        <!-- full moon -->
        <a-circle radius="50" position="200 250 -250" rotation="0 -25 0"></a-circle>

        <!-- walls -->
        <a-box width="50" depth="0.1" height="5" color="#f7fafd" position="0 2.5 -25"></a-box>
        <a-box width="50" depth="0.1" height="5" color="#f7fafd" position="-15 2.5 0" rotation="0 90 0"></a-box>
        <a-box width="50" depth="0.1" height="5" color="#f7fafd" position="15 2.5 0" rotation="0 90 0"></a-box>
        <a-box width="75" depth="0.1" height="5" color="#f7fafd" position="0 2.5 5"></a-box>

      </a-level>

      <a-level id="end">
        <a-text
          value="SUP3RFR1GHT VR"
          align="center"
          color="#ef2d5e"
          font="monoid"
          width="20"
          position="0 2.5 -5"
        ></a-text>
        
        <a-text value="THANK YOU FOR PLAYING!" align="center" color="black" font="monoid" width="8" position="0 1.6 -5"></a-text>
        <a-text value="NO 3D SHAPES WERE HARMED\nIN THE MAKING OF THIS GAME\n(IT'S ALL VIRTUAL ANYWAY)" align="center" color="black" font="monoid" width="8" position="0 0.25 -5.5"></a-text>

        <a-portal position="0 1 -0.65" to="#level_1" text-value="RETRY" text-width="1.75"></a-portal>
      </a-level></script></body></html>